// v0.15
// 10 Jun 19

@PART[OrbitalGrapplerJR]:NEEDS[OrbitalTug]:After[OrbitalTug] 
{
	node_stack_LftFwdWheel = 0.626,-0.63,0,1,0,0,0
	node_stack_LftMidWheel = 0.626,0,0,1,0,0,0
	node_stack_LftAftWheel = 0.626,0.63,0,1,0,0,0

	node_stack_RgtFwdWheel = -0.626,-0.63,0,-1,0,0, 0
	node_stack_RgtMidWheel = -0.626,0,0,-1,0,0, 0
	node_stack_RgtAftWheel = -0.626,0.63,0,-1,0,0, 0

	node_stack_BtmFwdWheel = 0,-0.63,-0.6,0,-1,0,0
	node_stack_BtmMidWheel = 0,0,-0.6,0,-1,0,0
	node_stack_BtmAftWheel = 0,0.63,-0.6,0,-1,0,0

	node_stack_behindGrappler = 0.0, -0.53, 0.67, 0,1,0,0

	MODULE:NEEDS[B9PartSwitch] {
		name = ModuleB9PartSwitch
		moduleID = sideNodes
		SUBTYPE {
			name = Triple Nodes
			node = LftFwdWheel
			node = LftMidWheel
			node = LftAftWheel
			
			node = RgtFwdWheel
			node = RgtMidWheel
			node = RgtAftWheel
			
			node = BtmFwdWheel
			node = BtmMidWheel
			node = BtmAftWheel
			
			node = behindGrappler
			//stackSymmetry = 3
		}
		SUBTYPE {
			name = Wheel Nodes
			node = LftFwdWheel
			node = LftMidWheel
			node = LftAftWheel
			
			node = RgtFwdWheel
			node = RgtMidWheel
			node = RgtAftWheel
			
			node = behindGrappler
			//stackSymmetry = 2
		}
		SUBTYPE {
			name = 60Â° Nodes
			node = LftFwdWheel
			node = LftMidWheel
			node = LftAftWheel
			
			node = RgtFwdWheel
			node = RgtMidWheel
			node = RgtAftWheel
			
			node = BtmFwdWheel
			node = BtmMidWheel
			node = BtmAftWheel
			
			node = behindGrappler
			stackSymmetry = 3
		}
		SUBTYPE {
			name = Spine Nodes
			node = BtmFwdWheel
			node = BtmMidWheel
			node = BtmAftWheel
			
			node = behindGrappler
			stackSymmetry = 0
		}
		SUBTYPE {
			name = No Nodes
		}
	}
	%CrewCapacity = 1
	%minimumCrew = 1
}

// add attachment nodess to OrbitalTugCore
// if B9PartSwitch installed, set up 4/2/0 node switch
// change node size from 2 to 1 to match rest of parts
@PART[OrbitalTugCore]:NEEDS[OrbitalTug]:After[OrbitalTug] {
   @node_stack_top = 0, 0.76, 0, 0, 1, 0, 1
   @node_stack_bottom = 0, -0.76, 0, 0, -1, 0, 1
	// add additional nodes
	node_stack_connect01 = 0.63, 0, 0, 1,0,0,	1
	node_stack_connect02 = -0.63, 0, 0, -1,0,0,	1
	node_stack_connect03 = 0, 0, 0.63, 0,0,1,	1
	node_stack_connect04 = 0, 0, -0.63, 0,0,-1,	1
	
	MODULE:NEEDS[B9PartSwitch] 	{
		name = ModuleB9PartSwitch
		moduleID = sideNodes
		SUBTYPE {
			name = Quad Nodes
			node = top
			node = bottom
			node = connect01
			node = connect02
			node = connect03
			node = connect04
			stackSymmetry = 3
		}
		SUBTYPE {
			name = Dual Nodes
			node = top
			node = bottom
			node = connect01
			node = connect02
			stackSymmetry = 1
		}       
		SUBTYPE {
			name = No Nodes
			node = top
			node = bottom
			stackSymmetry = 0
		}
	}	
} 

// Add Attachment nodes to engineOnArm
// Correct attachRules to allow node attachment
// if B9PartSwitch installed, set up 3/1 node switch
@PART[engineOnArm]:NEEDS[OrbitalTug]:After[OrbitalTug] {
	node_stack_connectMain01 = 0,0,0.3, 0,0,1,1
	
	node_stack_S01 = 0,0.3 ,0.3, 0,0,-1,0
	node_stack_S02 = 0,-0.45 ,0.24, 0,0,-1,0
	
	@attachRules = 1,1,1,0,0
	
	MODULE:NEEDS[B9PartSwitch]	{
	name = ModuleB9PartSwitch
	moduleID = hiddenNodes
		SUBTYPE {
			name = No Nodes
			node = connectMain01
		}
		SUBTYPE {
			name = Extra Nodes
			node = connectMain01
			node = S01
			node = S02
			stackSymmetry = 3
		}
	}
}

// Add Attachment nodes to helperDrone
// Correct attachRules to allow node attachment
// if B9PartSwitch installed, set up 2/1 node switch
@PART[helperDrone]:NEEDS[OrbitalTug]:After[OrbitalTug] {
	node_stack_top = 0.0, 0.22, 0.0, 0,1,0,0
	node_stack_bottom = 0.0, -0.2, 0.0, 0,-1,0,0
	
	@attachRules = 1,1,1,0,0
	
	MODULE:NEEDS[B9PartSwitch]	{
	name = ModuleB9PartSwitch
	moduleID = hiddenNodes
		SUBTYPE {
			name = Bottom Node
			node = bottom
		}
		SUBTYPE {
			name = Both Nodes
			node = top
			node = bottom
		}
		SUBTYPE {
			name = Top Nodes
			node = top
		}
		SUBTYPE {
			name = No Nodes
		}
	}
}

// Add Attachment nodes to DronePod
// Correct attachRules to allow node attachment
// if B9PartSwitch installed, set up 7/5/3/1 node switch
@PART[DronePod]:NEEDS[OrbitalTug]:After[OrbitalTug]
{
	node_stack_connect01 = -0.58, 0.0, 0.0, -1,0,0,0
	node_stack_connect02 = 0.58, 0.0, 0.0, 1,0,0,0

	node_stack_connect03 = -0.54, 0.4, 0.0, -1,0,0,0
	node_stack_connect04 = 0.54, 0.4, 0.0, 1,0,0,0
	
	node_stack_connect05 = -0.38, 0.8, 0.0, 0,1,0,0
	node_stack_connect06 = 0.38, 0.8, 0.0, 0,1,0,0
	
	// inside cargo bays facing out
	node_stack_front01 =  0.3, 0.5, -0.1, 0,0,-1, 0
	node_stack_front02 =  0.0, 0.5, -0.1, 0,0,-1, 0
	node_stack_front03 = -0.3, 0.5, -0.1, 0,0,-1, 0
	
	node_stack_front04 =  0.3, 0.7, -0.1, 0,0,-1, 0
	node_stack_front05 =  0.0, 0.7, -0.1, 0,0,-1, 0
	node_stack_front06 = -0.3, 0.7, -0.1, 0,0,-1, 0
	
	node_stack_front07 =  0.3, 0.3, -0.1, 0,0,-1, 0
	node_stack_front08 =  0.0, 0.3, -0.1, 0,0,-1, 0
	node_stack_front09 = -0.3, 0.3, -0.1, 0,0,-1, 0
	
	node_stack_back01 =  0.3, 0.5, 0.1, 0,0,1, 0
	node_stack_back02 =  0.0, 0.5, 0.1, 0,0,1, 0
	node_stack_back03 = -0.3, 0.5, 0.1, 0,0,1, 0

	node_stack_back04 =  0.3, 0.7, 0.1, 0,0,1, 0
	node_stack_back05 =  0.0, 0.7, 0.1, 0,0,1, 0
	node_stack_back06 = -0.3, 0.7, 0.1, 0,0,1, 0

	node_stack_back07 =  0.3, 0.3, 0.1, 0,0,1, 0
	node_stack_back08 =  0.0, 0.3, 0.1, 0,0,1, 0
	node_stack_back09 = -0.3, 0.3, 0.1, 0,0,1, 0
	
	// inside cargo bay - facing forward
	node_stack_connect07 = 0.0, 0.15, -0.4, 0,1,0, 0
	node_stack_connect08 = 0.34, 0.15, -0.19, 0,1,0, 0
	node_stack_connect09 = -0.34, 0.15, -0.19, 0,1,0, 0
	
	node_stack_connect10 = 0.0, 0.15, 0.4, 0,1,0, 0
	node_stack_connect11 = 0.34, 0.15, 0.19, 0,1,0, 0
	node_stack_connect12 = -0.34, 0.15, 0.19, 0,1,0, 0
	
	// outside base facing out
	node_stack_connect13 = 0.0, -0.02, -0.63, 0,0,-1, 0
	node_stack_connect14 = 0.0, -0.02, 0.63, 0,0,-1, 0
	
	@attachRules = 1,1,1,0,0
	
	MODULE:NEEDS[B9PartSwitch]	{
		name = ModuleB9PartSwitch
		moduleID = noNodes
		SUBTYPE {
			name = No Nodes
			node = connect13
			node = connect14
		}
		SUBTYPE {
			name = Bottom 
			node = connect01
			node = connect02
			node = connect13
			node = connect14
			stackSymmetry = 2
		}
		SUBTYPE {
			name = Botom Mid 
			node = connect01
			node = connect02
			node = connect03
			node = connect04
			node = connect13
			node = connect14
			stackSymmetry = 2
		}
		SUBTYPE {
			name = Botom Mid Top 
			node = connect01
			node = connect02
			node = connect03
			node = connect04
			node = connect05
			node = connect06
			node = connect13
			node = connect14
			stackSymmetry = 2
		}
		SUBTYPE {
			name = Inside Back Bay 
			node = connect07
			node = connect08
			node = connect09
			node = connect10
			node = connect11
			node = connect12
			node = connect13
			node = connect13
			node = connect14
			stackSymmetry = 2
		}
		SUBTYPE {
			name = BMT and Inside Back Bay
			node = connect01
			node = connect02
			node = connect03
			node = connect04
			node = connect05
			node = connect06
			node = connect07
			node = connect08
			node = connect09
			node = connect10
			node = connect11
			node = connect12
			node = connect13
			node = connect14
			stackSymmetry = 2
		}
		SUBTYPE {
			name = Bill and Bob went nutz
			node = connect01
			node = connect02
			node = connect03
			node = connect04
			node = connect05
			node = connect06
			node = front01
			node = front02
			node = front03
			node = front04
			node = front05
			node = front06
			node = front07
			node = front08
			node = front09
			node = back01
			node = back02
			node = back03
			node = back04
			node = back05
			node = back06
			node = back07
			node = back08
			node = back09
			node = connect07
			node = connect08
			node = connect09
			node = connect10
			node = connect11
			node = connect12
			node = connect13
			node = connect14
			stackSymmetry = 2
		}
	}
}

// Add Attachment nodes to OrbitalTugPod
// Correct attachRules to allow node attachment
// if B9PartSwitch installed, set up 7/5/3/1 node switch
@PART[OrbitalTugPod]:NEEDS[OrbitalTug]:After[OrbitalTug]
{
	node_stack_AftMid = -0.58, 0.0, 0.0, -1,0,0,0
	node_stack_AftMid = 0.58, 0.0, 0.0, 1,0,0,0

	node_stack_MidMid = -0.5, 0.4, 0.0, -1,0,0,0
	node_stack_MidMid = 0.5, 0.4, 0.0, 1,0,0,0
	
	node_stack_FwdMid = -0.31, 0.87, 0.0, 0,1,0,0
	node_stack_FwdMid = 0.31, 0.87, 0.0, 0,1,0,0

	// outside base facing out
	node_stack_MidAftTop = 0.0, -0.02, -0.63, 0,0,-1, 0
	node_stack_MidAftBottom = 0.0, -0.02, 0.63, 0,0,-1, 0

	@attachRules = 1,1,1,0,0
	
	MODULE:NEEDS[B9PartSwitch]	{
	name = ModuleB9PartSwitch
	moduleID = noNodes
		SUBTYPE {
			name = No Nodes
			name = MidAftTop
			name = MidAftBottom
		}
		SUBTYPE {
			name = Aft Nodes
			node = AftMid
			node = AftMid
			name = MidAftTop
			name = MidAftBottom
			stackSymmetry = 2
		}
		SUBTYPE {
			name = Aft Mid Nodes
			node = MidMid
			node = MidMid
			node = MidMid
			node = MidMid
			name = MidAftTop
			name = MidAftBottom
			stackSymmetry = 2
		}
		SUBTYPE {
			name = All Nodes
			node = AftMid
			node = AftMid
			node = MidMid
			node = MidMid
			node = FwdMid
			node = FwdMid
			name = MidAftTop
			name = MidAftBottom
			stackSymmetry = 2
		}
	}
}

// Add Attachment nodes to fwdAdaptor
// Correct attachRules to allow node attachment
// if B9PartSwitch installed, set up ?? node switch
@PART[fwdAdaptor]:NEEDS[OrbitalTug]:After[OrbitalTug] {
	// correct node orientation
	@node_stack_mid = 	0,-0.01,0, 0,1,0, 1
	
	node_stack_connect01 = -0.09, -0.35, -0.09, -1,0,-1,0
	node_stack_connect02 = 0.09, -0.35, 0.09, 1,0,1,0
	
	node_stack_connect03 = 0.09, -0.35, -0.09, 1,0,-1,0
	node_stack_connect04 = -0.09, -0.35, 0.09, -1,0,1,0
	
	node_stack_connect05 = -0.37, 0.0, -0.63, -.8,0,-.9,0
	node_stack_connect06 = 0.37, 0.0, 0.63, -.8,0,-.9,0
	node_stack_connect07 = -0.37, 0.0, 0.63, -.8,0,.9,0
	node_stack_connect08 = 0.37, 0.0, -0.63, .8,0,-.9,0
		
	node_stack_connect09 = -0.37, 0.6, -0.63, -.8,0,-.9,0
	node_stack_connect10 =  0.37, 0.6, 0.63, -.8,0,-.9,0
	node_stack_connect11 = -0.37, 0.6, 0.63, -.8,0,.9,0
	node_stack_connect12 =  0.37, 0.6, -0.63, .8,0,-.9,0
		
	node_stack_connect13 = -0.37, 1.2, -0.63, -.8,0,-.9,0
	node_stack_connect14 =  0.37, 1.2, 0.63, -.8,0,-.9,0
	node_stack_connect15 = -0.37, 1.2, 0.63, -.8,0,.9,0
	node_stack_connect16 =  0.37, 1.2, -0.63, .8,0,-.9,0
	
	MODULE:NEEDS[B9PartSwitch]	{
		name = ModuleB9PartSwitch
		moduleID = Nodes
		SUBTYPE {
			name = All
			node = connect01
			node = connect02
			node = connect03
			node = connect04

			node = connect05
			node = connect06
			node = connect07
			node = connect08

			node = connect09
			node = connect10
			node = connect11
			node = connect12

			node = connect13
			node = connect14
			node = connect15
			node = connect16
			stackSymmetry = 2
		}
		SUBTYPE {
			name = Inside
			node = connect01
			node = connect02
			node = connect03
			node = connect04
			stackSymmetry = 2
		}
		SUBTYPE {
			name = Outside
			node = connect05
			node = connect06
			node = connect07
			node = connect08
			node = connect09
			node = connect10
			node = connect11
			node = connect12
			node = connect13
			node = connect14
			node = connect15
			node = connect16
			stackSymmetry = 2
		}
		SUBTYPE {
			name = Plain
			stackSymmetry = 2
		}
	}
}

// Add Attachment nodes to adaptorCarrier
// Correct attachRules to allow node attachment
// if B9PartSwitch installed, set up ?? node switch
@PART[adaptorCarrier]:NEEDS[OrbitalTug]:After[OrbitalTug] 
{
	// correct node orientation
	@node_stack_mid = 0,-0.01,0, 0,1,0, 1 

	// helperpods
	node_stack_connectAftIn01 = -0.14, -0.35, -0.15, -1,0,-1,0
	node_stack_connectAftIn02 = 0.14, -0.35, 0.15, 1,0,1,0
	node_stack_connectAftIn03 = 0.14, -0.35, -0.15, 1,0,-1,0
	node_stack_connectAftIn04 = -0.14, -0.35, 0.15, -1,0,1,0
	
	// lower carrier outside
	node_stack_connectAftOut17 = -0.65, -0.35, -0, -1,0,0,0
	node_stack_connectAftOut18 = 0.65, -0.35, 0, 1,0,0,0
	node_stack_connectAftOut19 = 0, -0.35, -0.65, 0,0,-1,0
	node_stack_connectAftOut20 = 0, -0.35, 0.65, 0,0,1,0

	// add nodes to outside of poles
	// lower outer
	node_stack_connectOutUpp05 = -0.37, 0, -0.63, -.8,0,-.9,0
	node_stack_connectOutUpp06 =  0.37, 0, 0.63, .8,0,.9,0
	node_stack_connectOutUpp07 = -0.37, 0, 0.63, -.8,0,.9,0
	node_stack_connectOutUpp08 =  0.37, 0, -0.63, .8,0,-.9,0
	// mid outer
	node_stack_connectOutMid09 = -0.382, 0.6, -0.642, -.8,0,-.9,0
	node_stack_connectOutMid10 =  0.382, 0.6, 0.642, .8,0,.9,0
	node_stack_connectOutMid11 = -0.382, 0.6, 0.642, -.8,0,.9,0
	node_stack_connectOutMid12 =  0.382, 0.6, 0.642, .8,0,-.9,0
	// upper outer
	node_stack_connectOutUpp13 = -0.37, 1.2, -0.63, -.8,0,-.9,0
	node_stack_connectOutUpp14 =  0.37, 1.2, 0.63, .8,0,.9,0
	node_stack_connectOutUpp15 = -0.37, 1.2, 0.63, -.8,0,.9,0
	node_stack_connectOutUpp16 =  0.37, 1.2, -0.63, .8,0,-.9,0

	// add nodes to inside of poles
	// lower inside
	node_stack_connectInLwr05 = -0.35, 0.2, -0.57, 0.8, 0,.9,0
	node_stack_connectInLwr06 =  0.35, 0.2,  0.57, -.8,0,-.9,0
	node_stack_connectInLwr07 = -0.35, 0.2,  0.57, .8,0,-.9,0
	node_stack_connectInLwr08 =  0.35, 0.2, -0.57, -.8,0,.9,0
	// mid inside
	node_stack_connectInMid09 = -0.35, 0.6, -0.57,  0.8, 0,.9,0
	node_stack_connectInMid10 =  0.35, 0.6,  0.57, -.8,0,-.9,0
	node_stack_connectInMid11 = -0.35, 0.6,  0.57, .8,0,-.9,0
	node_stack_connectInMid12 =  0.35, 0.6, -0.57,  -.8,0,.9,0
	// upper inside
	node_stack_connectInUpp13 = -0.27, 1.2, -0.53, 0.8, 0,.9,0
	node_stack_connectInUpp14 =  0.27, 1.2,  0.53, -.8,0,-.9,0
	node_stack_connectInUpp15 = -0.27, 1.2,  0.53, .8,0,-.9,0
	node_stack_connectInUpp16 =  0.27, 1.2, -0.53,  -.8,0,.9,0
	
	MODULE:NEEDS[B9PartSwitch]	{
	name = ModuleB9PartSwitch
	moduleID = Nodes
		SUBTYPE {
			name = All
			node = connectAftIn01
			node = connectAftIn02
			node = connectAftIn03
			node = connectAftIn04
			node = connectOutUpp05
			node = connectOutUpp06
			node = connectOutUpp07
			node = connectOutUpp08
			node = connectOutMid09
			node = connectOutMid10
			node = connectOutMid11
			node = connectOutMid12
			node = connectOutUpp13
			node = connectOutUpp14
			node = connectOutUpp15
			node = connectOutUpp16
			node = connectInLwr05
			node = connectInLwr06
			node = connectInLwr07
			node = connectInLwr08
			node = connectInMid09
			node = connectInMid10
			node = connectInMid11
			node = connectInMid12
			node = connectInUpp13
			node = connectInUpp14
			node = connectInUpp15
			node = connectInUpp16
			node = connectAftOut17
			node = connectAftOut18
			node = connectAftOut19
			node = connectAftOut20
			stackSymmetry = 2
		}
		SUBTYPE {
			name = Inside
			node = connectAftIn01
			node = connectAftIn02
			node = connectAftIn03
			node = connectAftIn04
			node = connectInLwr05
			node = connectInLwr06
			node = connectInLwr07
			node = connectInLwr08
			node = connectInMid09
			node = connectInMid10
			node = connectInMid11
			node = connectInMid12
			node = connectInUpp13
			node = connectInUpp14
			node = connectInUpp15
			node = connectInUpp16
			stackSymmetry = 2
		}
		SUBTYPE {
			name = Outside
			node = connectAftIn01
			node = connectAftIn02
			node = connectAftIn03
			node = connectAftIn04
			node = connectOutUpp05
			node = connectOutUpp06
			node = connectOutUpp07
			node = connectOutUpp08
			node = connectOutMid09
			node = connectOutMid10
			node = connectOutMid11
			node = connectOutMid12
			node = connectOutUpp13
			node = connectOutUpp14
			node = connectOutUpp15
			node = connectOutUpp16
			node = connectAftOut17
			node = connectAftOut18
			node = connectAftOut19
			node = connectAftOut20
			stackSymmetry = 2
		}
		SUBTYPE {
			name = Plain
		}
	}
}

// zer0Kerbal
